---
apic:
  tenants:
    - name: edge
      vrfs:
        - name: edge.vrf-01
          contracts:
            providers:
              - edge-vzany
            consumers:
              - edge-vzany
            
      bridge_domains:
        - name: 10.61.134.0-24
          vrf: edge.vrf-01
          dhcp_labels:
            - dhcp_relay_policy: ad1.amsdmz.local
              scope: tenant
          subnets: 
          - ip: 10.61.134.1/24
            shared: true
            public: true    
        - name: 10.2.10.0-24
          vrf: edge.vrf-01
          subnets: 
          - ip: 10.2.10.1/24

      application_profiles:
        - name: network-segments
          endpoint_groups:
            - name: vms
              physical_domains:
                - edge
              bridge_domain: 10.61.134.0-24
              subnets:
                - ip: 10.61.134.1/24
                  public: true
                  shared: true
              contracts:
                providers:
                  - permit-to-10.61.134.0-24
                imported_consumers:
                  - permit-to-nutanix-10.61.128.0-24
                  - permit-to-flexpod-10.61.132.0-24
            - name: storage
              physical_domains:
                - edge
              bridge_domain: 10.2.10.0-24

      policies:
        dhcp_relay_policies:
          - name: ad1.amsdmz.local
            providers:
              - ip: 10.100.10.20
                type: external_epg
                tenant: infraservices
                l3out: infraservices.vrf-01.l3out-bgp-core
                external_endpoint_group: external-subnets

      contracts:
        - name: permit-to-10.61.134.0-24
          scope: global
          subjects:
            - name: all-entries
              filters:
                - filter: ip-src-any-to-dst-any
                
        - name: edge-vzany
          scope: context
          subjects:
            - name: all-entries
              filters:
                - filter: ip-src-any-to-dst-any

      filters:
        - name: ip-src-any-to-dst-any
          entries:
            - name: src-any-to-dst-any
              ethertype: ip
              protocol: unspecified

      imported_contracts:
        - name: permit-to-nutanix-10.61.128.0-24
          tenant: nutanix
          contract: permit-to-10.61.128.0-24
        - name: permit-to-flexpod-10.61.132.0-24
          tenant: flexpod
          contract: permit-to-10.61.132.0-24